<?php
// PHP BILKUL PEHLE
$con = mysqli_connect("localhostsql113.infinityfree.com","if0_40548515","exYfHbCHoVacr","if0_40548515_files");
$showError = false;

if(isset($_POST['btn']))
{
    $Email    = $_POST['txtEmail'];
    $Password = $_POST['txtPass'];

    $msql = "select * from userinfo where Email = '$Email' and Password = '$Password'";
    $mRs  = mysqli_query($con, $msql);
    $mRow = mysqli_fetch_array($mRs);

    if(mysqli_num_rows($mRs) > 0)
    {
        if($mRow['Roll'] > 0)
        {
            header("location:Admin.php");
            exit;
        }
        else
        {
            session_start();
            $_SESSION['sname'] = $mRow['Name'];
            header("location:show.php");
            exit;
        }
    }
    else
    {
        $showError = true;
    }
}
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Login</title>

    <style>
        *{ box-sizing:border-box; margin:0; padding:0; }

        body{
            height:100vh;
            display:flex; justify-content:center; align-items:center;
            font-family:"Poppins", sans-serif;
            background:#0f0f0f;
        }

        /* LOGIN BOX */
        .login-box{
            width:350px; padding:30px;
            background:rgba(255,255,255,0.05);
            border-radius:22px; backdrop-filter:blur(14px);
            box-shadow:0 0 25px rgba(0,255,255,0.12);
            border:1px solid rgba(0,255,255,0.18);
            color:#e3ffff; animation:fadeIn 0.9s ease;
        }
        @keyframes fadeIn{
            from{ opacity:0; transform:scale(0.95); }
            to  { opacity:1; transform:scale(1); }
        }

        .login-box h2{
            text-align:center; margin-bottom:25px;
            font-size:30px; font-weight:700;
            color:#00eaff; text-shadow:0 0 10px #00eaff66;
        }

        /* Inputs */
        .input-box{ margin-bottom:18px; position:relative; }
        .input-box input{
            width:100%; padding:12px; padding-right:42px;
            border-radius:12px; font-size:16px; outline:none;
            background:rgba(0,0,0,0.4);
            border:1px solid #00eaff55; color:#d8ffff;
        }
        .input-box input::placeholder{ color:#b9faff; }

        /* Eye */
        .eye-toggle{
            position:absolute; right:13px; top:50%;
            transform:translateY(-50%);
            cursor:pointer; font-size:18px;
            color:#00eaff88; user-select:none; transition:0.2s;
        }
        .eye-toggle:hover{ color:#00eaff; }

        /* Buttons */
        .btn-box{ display:flex; justify-content:space-between; margin-top:12px; }
        .btn{
            width:48%; padding:12px; border:none;
            border-radius:14px; font-size:16px; cursor:pointer;
            color:white; font-weight:600;
            background:linear-gradient(135deg,#00eaff,#0088ff);
            box-shadow:0 4px 12px rgba(0,255,255,0.25);
            transition:0.3s ease;
        }
        .btn:hover{ transform:scale(1.05); box-shadow:0 6px 18px rgba(0,255,255,0.35); }
        .reset-btn{ background:linear-gradient(135deg,#ff4444,#d30000); }
        .reset-btn:hover{ box-shadow:0 6px 18px rgba(255,0,0,0.35); }

        /* Error */
        .alert-box{
            background:rgba(255,68,68,0.12); border:1px solid #ff444433;
            color:#ff8888; padding:10px 14px; border-radius:10px;
            margin-bottom:16px; font-size:14px; text-align:center;
        }

        /* Register Link */
        .reg-link{
            text-align:center; margin-top:16px;
            font-size:14px; color:#aaf0ff;
        }
        .reg-link span{
            color:#00eaff; font-weight:700;
            cursor:pointer; text-decoration:underline;
            transition:0.2s;
        }
        .reg-link span:hover{ color:#7af2ff; }

        /* ===== REGISTER MODAL ===== */
        .modal-overlay{
            display:none; position:fixed; inset:0;
            background:rgba(0,0,0,0.75);
            backdrop-filter:blur(4px);
            z-index:999;
            justify-content:center; align-items:center;
            animation:fadeIn 0.3s ease;
        }
        .modal-overlay.open{ display:flex; }

        .modal-box{
            width:95%; max-width:420px;
            max-height:90vh;
            background:#141414;
            border-radius:22px;
            border:1px solid #00eaff33;
            box-shadow:0 0 40px rgba(0,255,255,0.15);
            overflow:hidden;
            position:relative;
            animation:popIn 0.35s ease;
        }
        @keyframes popIn{
            from{ opacity:0; transform:scale(0.88); }
            to  { opacity:1; transform:scale(1); }
        }

        /* Close button */
        .modal-close{
            position:absolute; top:12px; right:16px;
            background:rgba(255,68,68,0.15);
            border:1px solid #ff444433;
            color:#ff6666; font-size:18px; font-weight:700;
            width:34px; height:34px; border-radius:50%;
            cursor:pointer; z-index:10;
            display:flex; align-items:center; justify-content:center;
            transition:0.2s;
        }
        .modal-close:hover{ background:rgba(255,68,68,0.3); color:#ff4444; }

        /* iframe fills modal */
        .modal-box iframe{
            width:100%; height:90vh;
            max-height:600px;
            border:none; display:block;
        }

        @media(max-width:400px){ .login-box{ width:90%; } }
    </style>
</head>
<body>

    <!-- LOGIN FORM -->
    <form method="POST" id="loginForm">
        <div class="login-box">
            <h2>üîê Login</h2>

            <?php if($showError): ?>
            <div class="alert-box">‚ùå Invalid Email or Password!</div>
            <?php endif; ?>

            <div class="input-box">
                <input type="text" name="txtEmail" id="txtEmail"
                       placeholder="Enter Email"
                       value="<?= isset($_POST['txtEmail']) ? htmlspecialchars($_POST['txtEmail']) : '' ?>"
                       required>
            </div>

            <div class="input-box">
                <input type="password" name="txtPass" id="txtPass"
                       placeholder="Enter Password" required>
                <span class="eye-toggle" onclick="togglePass()">üëÅÔ∏è</span>
            </div>

            <div class="btn-box">
                <input type="submit" name="btn" value="Login" class="btn">
                <input type="button" value="Reset" class="btn reset-btn" onclick="resetForm()">
            </div>

            <!-- Register link -->
            <div class="reg-link">
                New user? <span onclick="openRegModal()">Register here</span>
            </div>
        </div>
    </form>

    <!-- ===== REGISTER MODAL ===== -->
    <div class="modal-overlay" id="regOverlay">
        <div class="modal-box">
            <button class="modal-close" onclick="closeRegModal()">‚úï</button>
            <iframe src="Ragistration.php" id="regFrame"></iframe>
        </div>
    </div>

<script>
// Password show/hide
function togglePass(){
    const f   = document.getElementById('txtPass');
    const eye = document.querySelector('.eye-toggle');
    if(f.type === 'password'){ f.type = 'text'; eye.textContent = 'üôà'; }
    else{ f.type = 'password'; eye.textContent = 'üëÅÔ∏è'; }
}

// Reset form
function resetForm(){
    document.getElementById('txtEmail').value = '';
    document.getElementById('txtPass').value  = '';
}

// Open register modal
function openRegModal(){
    document.getElementById('regOverlay').classList.add('open');
    document.body.style.overflow = 'hidden';
}

// Close register modal
function closeRegModal(){
    document.getElementById('regOverlay').classList.remove('open');
    document.body.style.overflow = '';
}

// Click outside modal to close
document.getElementById('regOverlay').addEventListener('click', function(e){
    if(e.target === this) closeRegModal();
});

// Close with ESC key
document.addEventListener('keydown', function(e){
    if(e.key === 'Escape') closeRegModal();
});
</script>
</body>
</html>